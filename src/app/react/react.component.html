<!-- Header Toolbar -->
<mat-toolbar class="react-header">
  <button mat-icon-button class="example-icon" aria-label="Menu">
    <mat-icon mat-button [matMenuTriggerFor]="menu">menu</mat-icon>
    <mat-menu #menu="matMenu">
      <button mat-menu-item (click)="loadAll()">
        <mat-icon>view_list</mat-icon>
        <span>All Levels</span>
      </button>
      <button mat-menu-item (click)="loadBeginner()">
        <mat-icon>looks_one</mat-icon>
        <span>Beginner Only</span>
      </button>
      <button mat-menu-item (click)="loadIntermediate()">
        <mat-icon>looks_two</mat-icon>
        <span>Intermediate Only</span>
      </button>
      <button mat-menu-item (click)="loadAdvanced()">
        <mat-icon>looks_3</mat-icon>
        <span>Advanced Only</span>
      </button>
      <mat-divider></mat-divider>
      <button mat-menu-item (click)="expandAll()">
        <mat-icon>unfold_more</mat-icon>
        <span>Expand All</span>
      </button>
      <button mat-menu-item (click)="collapseAll()">
        <mat-icon>unfold_less</mat-icon>
        <span>Collapse All</span>
      </button>
      <mat-divider></mat-divider>
      <button mat-menu-item (click)="exportProgress()">
        <mat-icon>download</mat-icon>
        <span>Export Progress</span>
      </button>
      <button mat-menu-item (click)="resetProgress()">
        <mat-icon>restart_alt</mat-icon>
        <span>Reset Progress</span>
      </button>
      <button mat-menu-item (click)="refreshData()">
        <mat-icon>refresh</mat-icon>
        <span>Refresh Data</span>
      </button>
    </mat-menu>
  </button>
  <span>React Core </span>  
  <img class="react-logo" src="../../assets/image/react.png" alt="React Logo">
  <span class="example-spacer"></span>
  
  <!-- Progress Badge -->
  <div class="progress-badge">
    <span class="progress-text">{{ completedTopics }} / {{ totalTopics }}</span>
    <mat-icon class="progress-icon">check_circle</mat-icon>
  </div>
  
  <button mat-icon-button class="example-icon" aria-label="Next Topic" (click)="getNextTopic()">
    <mat-icon>arrow_forward</mat-icon>
  </button>
  <button mat-icon-button class="example-icon favorite-icon" aria-label="Favorite">
    <mat-icon>favorite</mat-icon>
  </button>
  <button mat-icon-button class="example-icon" aria-label="Share">
    <mat-icon>share</mat-icon>
  </button>
</mat-toolbar>

<!-- Loading Spinner Overlay -->
<div *ngIf="isLoading" class="loading-overlay">
  <mat-spinner diameter="60"></mat-spinner>
  <p class="loading-text">Loading React Learning Path...</p>
</div>

<!-- Error Message -->
<div *ngIf="loadingError" class="error-message">
  <mat-icon class="error-icon">error_outline</mat-icon>
  <h3>Oops! Something went wrong</h3>
  <p>{{ loadingError }}</p>
  <button mat-raised-button color="primary" (click)="refreshData()">
    <mat-icon>refresh</mat-icon>
    Try Again
  </button>
</div>

<!-- Main Learning Path Container -->
<div class="learning-container" *ngIf="!isLoading && !loadingError">
  
  <!-- Search and Filter Bar -->
  <div class="search-filter-section">
    <mat-form-field class="search-field" appearance="outline">
      <mat-label>Search topics...</mat-label>
      <input matInput 
             [(ngModel)]="searchQuery" 
             (input)="onSearchChange()" 
             placeholder="e.g., hooks, state, props">
      <mat-icon matPrefix>search</mat-icon>
      <button *ngIf="searchQuery" 
              matSuffix 
              mat-icon-button 
              aria-label="Clear" 
              (click)="clearSearch()">
        <mat-icon>close</mat-icon>
      </button>
    </mat-form-field>
    
    <div class="filter-chips">
      <mat-chip-set aria-label="Level filter">
        @for (level of availableLevels; track level) {
          <mat-chip 
            [highlighted]="selectedLevels.includes(level)"
            (click)="toggleLevelFilter(level)"
            class="level-chip"
            [class.chip-beginner]="level === 'Beginner'"
            [class.chip-intermediate]="level === 'Intermediate'"
            [class.chip-advanced]="level === 'Advanced'"
            [class.chip-expert]="level === 'Expert'"
            [class.chip-professional]="level === 'Professional'">
            <mat-icon matChipAvatar>
              @if (level === 'Beginner') { filter_1 }
              @else if (level === 'Intermediate') { filter_2 }
              @else if (level === 'Advanced') { filter_3 }
              @else if (level === 'Expert') { filter_4 }
              @else { filter_5 }
            </mat-icon>
            {{ level }}
          </mat-chip>
        }
      </mat-chip-set>
      
      @if (searchQuery || selectedLevels.length > 0) {
        <button mat-button color="warn" (click)="resetFilters()">
          <mat-icon>clear_all</mat-icon>
          Clear Filters
        </button>
      }
    </div>
    
    <div class="stats-summary">
      <div class="stat-item">
        <mat-icon>schedule</mat-icon>
        <span>{{ getEstimatedTimeRemaining() }}</span>
      </div>
      <div class="stat-item">
        <mat-icon>trending_up</mat-icon>
        <span>{{ progressPercentage }}% Complete</span>
      </div>
    </div>
  </div>
  
  <!-- Hero Section -->
  <div class="hero-section">
    <div class="hero-content">
      <h1 class="hero-title">
        <span class="react-emoji">‚öõÔ∏è</span>
        React Learning Roadmap
      </h1>
      <p class="hero-description">
        Master React from basics to advanced ‚Äî A comprehensive guide from beginner to expert level
      </p>
      
      <!-- Overall Progress Bar -->
      <div class="overall-progress">
        <div class="progress-header">
          <span class="progress-label">Your Learning Progress</span>
          <span class="progress-percentage">{{ progressPercentage }}%</span>
        </div>
        <div class="progress-bar-container">
          <div class="progress-bar-fill" [style.width.%]="progressPercentage"></div>
        </div>
        <div class="progress-stats">
          <span>{{ completedTopics }} completed</span>
          <span>‚Ä¢</span>
          <span>{{ totalTopics - completedTopics }} remaining</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Learning Path Roadmap -->
  <div class="roadmap-container">
    @for (section of reactLearningPath(); track section.id; let i = $index) {
      <div class="roadmap-section" [class.expanded]="section.expanded">
        <!-- Section Card -->
        <div class="section-card" [attr.data-level]="section.level">
          <!-- Level Badge -->
          <div class="level-badge" [attr.data-color]="section.color">
            <span class="level-emoji">{{ section.emoji }}</span>
            <span class="level-text">{{ section.level }}</span>
          </div>

          <!-- Section Header -->
          <div class="section-header" (click)="toggleSection(section.id!)">
            <div class="section-info">
              <h2 class="section-title">
                <span class="section-number">{{ i + 1 }}.</span>
                {{ section.title }}
              </h2>
              <p class="section-description">{{ section.description }}</p>
              
              <!-- Section Stats -->
              <div class="section-stats">
                <div class="stat-item">
                  <mat-icon class="stat-icon">school</mat-icon>
                  <span>{{ section.topics.length }} Topics</span>
                </div>
                <div class="stat-item">
                  <mat-icon class="stat-icon">check_circle</mat-icon>
                  <span>{{ getSectionProgress(section) }}% Complete</span>
                </div>
              </div>
            </div>

            <!-- Expand/Collapse Icon -->
            <button mat-icon-button class="expand-button">
              <mat-icon>{{ section.expanded ? 'expand_less' : 'expand_more' }}</mat-icon>
            </button>
          </div>

          <!-- Section Progress Bar -->
          <div class="section-progress-bar">
            <div class="section-progress-fill" 
                 [style.width.%]="getSectionProgress(section)"
                 [class]="'gradient-' + section.color"></div>
          </div>

          <!-- Topics List (Expandable) -->
          @if (section.expanded) {
            <div class="topics-list">
              @for (topic of section.topics; track topic.id; let j = $index) {
                <div class="topic-card" 
                     [class.completed]="topic.isCompleted"
                     (click)="toggleTopicCompletion(section, topic, $event)">
                  <!-- Topic Number & Checkbox -->
                  <div class="topic-checkbox">
                    @if (topic.isCompleted) {
                      <mat-icon class="check-icon">check_circle</mat-icon>
                    } @else {
                      <span class="topic-number">{{ j + 1 }}</span>
                    }
                  </div>

                  <!-- Topic Content -->
                  <div class="topic-content">
                    <h3 class="topic-title">{{ topic.title }}</h3>
                    <p class="topic-description">{{ topic.description }}</p>
                    
                    <!-- Topic Meta -->
                    @if (topic.estimatedTime) {
                      <div class="topic-meta">
                        <mat-icon class="meta-icon">schedule</mat-icon>
                        <span class="meta-text">{{ topic.estimatedTime }}</span>
                      </div>
                    }
                  </div>

                  <!-- Action Button -->
                  <button mat-icon-button 
                          class="topic-action"
                          (click)="viewTopicDetails(section, topic, $event)">
                    <mat-icon>{{ topic.isCompleted ? 'visibility' : 'play_arrow' }}</mat-icon>
                  </button>
                </div>
              }
            </div>
          }
        </div>

        <!-- Connecting Line (except for last section) -->
        @if (i < reactLearningPath.length - 1) {
          <div class="roadmap-connector"></div>
        }
      </div>
    }
  </div>

  <!-- Completion Achievement -->
  @if (progressPercentage === 100) {
    <div class="achievement-banner">
      <div class="achievement-content">
        <mat-icon class="achievement-icon">emoji_events</mat-icon>
        <h2 class="achievement-title">üéâ Congratulations!</h2>
        <p class="achievement-text">You've completed the entire React learning roadmap!</p>
      </div>
    </div>
  }
</div>
  